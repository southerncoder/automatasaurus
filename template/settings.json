{
  "permissions": {
    "allow": [
      "Bash(git:*)",
      "Bash(gh:*)",
      "Bash(npm:*)",
      "Bash(npx:*)",
      "Bash(*/.claude/hooks/*)",
      "WebSearch"
    ],
    "deny": [
      "Read(./.env)",
      "Read(./.env.*)",
      "Read(./secrets/**)"
    ]
  },
  "hooks": {
    "Stop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Evaluate whether Claude should stop working. Context: $ARGUMENTS\n\nAs the workflow coordinator, check the following:\n\n## Workflow Loop Check\n1. Are there open GitHub issues that still need work? (Check with: gh issue list --state open)\n2. Are there PRs awaiting review or action? (Check with: gh pr list --state open)\n3. Is the current issue/PR fully completed and merged?\n\n## Task Completion Check\n4. Has the assigned task been fully completed?\n5. Are there any errors or failing tests?\n6. Has all work been properly tracked in GitHub?\n\n## Handoff Check\n7. Have all required reviewers approved (if PR is open)?\n8. Is the Tester ready to do final verification?\n9. Should the loop continue to the next issue?\n\n## Escalation Check\n10. Is Claude stuck and needs human intervention?\n11. Should a notification be sent to the user?\n\nRespond with JSON:\n- decision: 'approve' (allow stop - all work complete or needs human input) or 'block' (continue working - more issues to process)\n- reason: explanation for your decision\n- systemMessage: context for next action (e.g., 'Continue to issue #X' or 'Awaiting human input on #Y')",
            "timeout": 60
          },
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR/.claude/hooks/on-stop.sh\""
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Evaluate if this subagent has completed its assigned task and is ready for handoff. Input: $ARGUMENTS\n\n## Role-Specific Completion Criteria\n\n### Product Owner\n- Issues created with proper format (User Story, Acceptance Criteria, Dependencies)\n- Dependencies documented with 'Depends on #X'\n- Labels applied (ready/blocked, priority)\n\n### Product Manager\n- Correct issue selected based on dependencies and priority\n- Proper routing to next agent in workflow\n- GitHub state updated (labels, comments)\n\n### Developer\n- Code implemented and tests passing\n- PR created with 'Closes #X' format\n- If stuck after 5 attempts, escalated to Architect\n\n### Architect\n- Code review completed (approve or request changes)\n- If reviewing stuck issue, provided analysis and recommendations\n- If also stuck, escalated to human\n\n### SecOps\n- If security-relevant: reviewed and provided feedback\n- If not relevant: commented 'N/A - No security impact'\n\n### UI/UX\n- If UI-relevant: provided specs or review\n- If not relevant: commented 'N/A - No UI changes'\n\n### Tester\n- Automated tests run\n- Manual verification done (if needed)\n- If approved: PR merged\n- If issues: sent back to Developer\n\nRespond with JSON:\n- decision: 'approve' (ready for handoff) or 'block' (more work needed)\n- reason: what was/wasn't completed\n- nextAgent: which agent should take over (if applicable)",
            "timeout": 30
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "echo 'Automatasaurus workflow initialized. GitHub integration ready.'"
          }
        ]
      }
    ]
  },
  "env": {
    "WORKFLOW_MODE": "automated",
    "GITHUB_WORKFLOW": "enabled",
    "AUTOMATASAURUS_SOUND": "true",
    "AUTOMATASAURUS_LOG": "/tmp/automatasaurus.log",
    "MAX_RETRY_ATTEMPTS": "5"
  }
}
